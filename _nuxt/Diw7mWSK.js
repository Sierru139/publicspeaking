import{u as de,q as pe,a as me,b as fe,c as S,d as G,e as ge,m as B,_ as ve,f as ye,g as be,h as he,i as _e,j as Ee,k as ke,l as De,n as xe,o as we,p as Pe}from"./h4vBiQz9.js";import{r as _,u as Q,a as Ce,w as Se,s as Be,c as Oe,b as Ve,o as Re,d as O,e as V,f as Te,g as r,h as E,t as W,i as qe,n as Le,j as R,k as $e,l as Ae,m as T,p as He}from"./CyOQlOYI.js";const Ne={key:0,class:"flex h-screen w-full items-center bg-gray"},Ie={class:"mx-auto"},je={class:"rounded bg-white p-[24px]"},Fe={class:"w-full text-center text-[28px] font-[600] leading-[32px] text-black-950"},Me={class:"mx-auto mt-[24px] text-center text-[12px] font-[500] leading-[18px] text-black-950"},Je={__name:"[[realSlug]]",async setup(Ue){var F,M,U,z,K;let k,q;const D=we(),x=de(),X=pe(),L=me(),Z=fe(),$=_(),A=_(),w=_(!1),ee=new Date().getFullYear(),P=Q().query.fbclid,te=S("_fbc",{maxAge:60*60*24*90,sameSite:"lax",secure:!0});P&&P!=="fbclid"&&(te.value=`fb.1.${Date.now()}.${P}`);const H=S("_fbp",{maxAge:60*60*24*90,sameSite:"lax",secure:!0});H.value||(H.value=`fb.1.${Date.now()}.${Math.floor(Math.random()*1e10)}`),S("_ttp",{maxAge:60*60*24*90,sameSite:"lax",secure:!0});const ae=G(),se=_(ae.host),N=He(),C=_(!1),{$cdnUrl:ne}=Ce(),I=e=>{let t=[];if(!e.general.hasForm)t=[];else{const s=ke(e.main,["type","main_form_items"]);s>-1?t.push(s):e.main.map((a,o)=>{a.type==="section"&&a.contents.map((l,d)=>{l.type==="main_form_items"&&t.push(o,d)})})}let n=null;if(t.length===2){const[s,a]=t;n=e.main[s].contents[a]}else if(t.length===1){const[s]=t;n=e.main[s]}return n},oe=e=>{var t,n,s,a,o;throw Pe({dsn:N.public.sentryDSN,tracesSampleRate:1}),((t=e.response)==null?void 0:t.status)===404&&((s=(n=e.response)==null?void 0:n._data)==null?void 0:s.message)==="Homepage not found."?T({statusCode:404,statusMessage:"Homepage not found.",data:{isNoHomepage:!0},name:(e==null?void 0:e.name)||"Error"}):T({statusCode:((a=e==null?void 0:e.response)==null?void 0:a.status)||500,statusMessage:((o=e==null?void 0:e.response)==null?void 0:o.status)===403?"Forbidden":"Error",data:{isNoHomepage:!1},name:"Error"})},j=async(e,t,n,s,a,o)=>{x.setIp(t||null),x.setReferer(s===void 0?null:s),x.setUA(a),x.setHost2(o);const l=await X.fetchPublicPage(`${e}${n}`).catch(p=>{if(p.response&&p.response.status===404)throw T({statusCode:404,statusMessage:"Not Found",name:"NotFound"});oe(p)});I(l.currentPageDisplay)&&await Z.fetchEnabledEPayments(l.business.username,N.public.nexusApiUrl);const d=!e.includes("scalev.id")&&!e.includes("scalev.com")&&!e.includes("localhost:");return{pageDisplayValues:l.currentPageDisplay,dataBind:{values:l.currentPageDisplay,idPage:l.id,uniqueIdPage:l.uniqueId,username:e.split(".")[0],isDisabledCustomFont:l.isDisabledCustomFont,isDisabledClientTagging:l.isDisabledClientTagging,business:l.business,isUsingExternalDomain:d},isRoot:!1}},{data:i,error:f}=([k,q]=Se(async()=>he("pageDisplayData",async()=>{var c,v,y,m,Y,J;const e=De(),t=xe(),n=Q(),{hostname:s,host:a,pathname:o}=G(),l=s.includes("localhost")?a:s,d=e["x-forwarded-for"]||((v=(c=t==null?void 0:t.req)==null?void 0:c.socket)==null?void 0:v.remoteAddress),p=e["user-agent"]||null,g=`${e["x-forwarded-proto"]}://${e.host}${n.path}`;if(n.params.realSlug){const u=await j(l,d,o,e.referer,p,g);$.value=u.pageDisplayValues,A.value=u.dataBind,w.value=u.isRoot;const b=[],h=[];return(Y=u.pageDisplayValues)==null||Y.onloadFbEvents.forEach(()=>{b.push(D())}),(J=u.pageDisplayValues)==null||J.onloadTiktokEvents.forEach(()=>{h.push(D())}),{...u,fbOnLoadEventIds:b,tiktokOnLoadEventIds:h,host:a}}else{const u=await j(l,d,o,e.referer,p,g);$.value=u.pageDisplayValues,A.value=u.dataBind,w.value=u.isRoot;const b=[],h=[];return(y=u.pageDisplayValues)==null||y.onloadFbEvents.forEach(()=>{b.push(D())}),(m=u.pageDisplayValues)==null||m.onloadTiktokEvents.forEach(()=>{h.push(D())}),{...u,fbOnLoadEventIds:b,tiktokOnLoadEventIds:h,host:a}}})),k=await k,q(),k);if(f.value&&((M=(F=f==null?void 0:f.value)==null?void 0:F.data)!=null&&M.isNoHomepage?w.value=!0:Be(f.value)),i.value){const e=(U=i.value.pageDisplayValues.general)==null?void 0:U.fontStyle;L.addFont(e?e.toLowerCase().split(" ").join("-"):""),(K=(z=i.value)==null?void 0:z.dataBind)!=null&&K.isDisabledCustomFont||ge({link:L.getFontList()})}const le=Oe(()=>i.value.dataBind.isUsingExternalDomain&&i.value.pageDisplayValues.meta.favicon?i.value.pageDisplayValues.meta.favicon:"/assets/default-favicon.ico");Ve(le,{rel:"icon"});const ie=()=>{var e;try{(e=document.querySelectorAll("video"))==null||e.forEach(t=>{_e(`${t.src} is playing inline`,{extra:{data:"from forceAllVideoElementsToPlayInline"}}),t.removeAttribute("autoplay"),t.setAttribute("playsinline","")})}catch(t){Ee(t,{extra:{data:"from forceAllVideoElementsToPlayInline"}})}};Re(()=>{if(ie(),C.value=window.self!==window.top,i.value)try{const{pageDisplayValues:e,isRoot:t,dataBind:n,fbOnLoadEventIds:s,tiktokOnLoadEventIds:a}=i.value;if(t)return;if(n.isDisabledCustomFont){const l=document.createElement("style");l.textContent=`
          .ql-font-page {
            font-family: inherit !important;
          }
        `,document.head.appendChild(l)}const o=I(e);s.length>0&&ce(s,o),a.length>0&&ue(a,o),e.onloadKwaiClientEvents.length>0&&re(o),e.general.fontStyle&&document.documentElement.style.setProperty("--system-font-quill",e.general.fontStyle),e.meta.isDisabledRightClick&&document.body.addEventListener("contextmenu",l=>{l.preventDefault()})}catch{}if(window.self!==window.top){const e=(n=0)=>{document.body.style.overflowY="hidden";const s=document.body.scrollHeight,a=JSON.stringify({type:"resize",height:s-n});window.parent.postMessage(a,"*")};new MutationObserver(()=>{const n=document.getElementById("locator").getBoundingClientRect(),s=document.body.scrollHeight,a=n.bottom+window.scrollY,o=s-a;e(o)}).observe(document.body,{attributes:!0,childList:!0,subtree:!0}),e()}});function ce(e,t){var d,p,g;const{pageDisplayValues:n}=i.value,s=t==null?void 0:t.values.itemsType,a=((d=t==null?void 0:t.values)==null?void 0:d.variantsObjects)||[],o=((p=t==null?void 0:t.values)==null?void 0:p.bundlesObjects)||[];let l={};(a.length>0||o.length>0)&&(l={content_ids:s==="bundle"?o[0].bundle.bundlelines.map(c=>c.variant.id):[a[0].id],content_category:s==="bundle"?"-":((g=a[0])==null?void 0:g.category)||"-",content_name:s==="bundle"?o[0].bundle.public_name:a[0].name,content_type:"product",contents:s==="bundle"?o[0].bundle.bundlelines.map(c=>({id:c.variant.id,quantity:c.quantity,delivery_category:"home_delivery",item_price:c.variant.price})):[{id:a[0].id,quantity:1,delivery_category:"home_delivery",item_price:a[0].price}],value:s==="bundle"?o[0].price:a[0].price,currency:"IDR",num_items:s==="bundle"?o[0].bundle.bundlelines.length:1}),console.log("testsss"),n.fbPixels.length>0&&setTimeout(()=>{B(n.onloadFbEvents,(c,v)=>{const y=n.fbEventsOnloadParameters[c]?Object.fromEntries(n.fbEventsOnloadParameters[c].map(m=>m.key&&m.value?[m.key,m.value]:[])):null;console.log("track",c,{...l,...y},{eventID:e[v]}),window.fbq("track",c,{...l,...y},{eventID:e[v]})})},0)}function ue(e){const{pageDisplayValues:t}=i.value;t.tiktokPixels.length>0&&setTimeout(()=>{B(t.onloadTiktokEvents,(n,s)=>{const a=t.tiktokEventsOnloadParameters[n]?Object.fromEntries(t.tiktokEventsOnloadParameters[n].map(o=>o.key&&o.value?[o.key,o.value]:[])):null;window.ttq.track(n,a,{event_id:e[s]})})},0)}function re(){const{pageDisplayValues:e}=i.value;e.kwaiClientPixels.length>0&&setTimeout(()=>{e.kwaiClientPixelsObjects.forEach(t=>{B(e.onloadKwaiClientEvents,n=>{const s=e.kwaiClientEventsOnloadParameters[n]?Object.fromEntries(e.kwaiClientEventsOnloadParameters[n].map(a=>a.key&&a.value?[a.key,a.value]:[])):null;window.kwaiq.instance(t.pixel_id).track(n,s)})})},0)}return(e,t)=>{const n=ve,s=ye,a=be;return V(),O("div",null,[r(w)?(V(),O("div",Ne,[E("div",Ie,[E("div",je,[E("p",Fe,W(r(se)),1)]),E("p",Me,[t[0]||(t[0]=qe(" Â© ")),E("span",null,W(r(ee))+" Scalev",1)])])])):r(i)?(V(),O("div",{key:1,class:"relative flex min-h-screen w-full flex-col",style:Le(`background-color: ${r(C)?"transaprent":r(i).dataBind.values.general.backgroundColor};--page-bg: ${r(C)?"transparent":r(i).dataBind.values.general.pageBackgroundColor};`)},[R(n,$e(Ae(r(i).dataBind)),null,16),R(s),R(a,{image:r(i).dataBind.isUsingExternalDomain?r(i).pageDisplayValues.meta.loadingLogo?r(i).pageDisplayValues.meta.loadingLogo:`${r(ne)}/assets/images/logo.svg`:void 0},null,8,["image"])],4)):Te("",!0)])}}};export{Je as default};
